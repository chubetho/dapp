import{_ as F}from"./ScrollArea.vue_vue_type_script_setup_true_lang-OZzAJiiF.js";import{c as I,d as V,q as M,s as P,v as z,y as S,o,j as i,C as e,A as m,z as a,u as n,a as N,w as l,F as f,f as d,B as g,n as $,ac as R,H as k,_ as E,I as L}from"./index-oOlvovHs.js";import{_ as T}from"./Badge.vue_vue_type_script_setup_true_lang-y6D-Z957.js";import{C as A}from"./chevron-down-V1NCBs-T.js";/**
 * @license lucide-vue-next v0.297.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=I("CornerDownRightIcon",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]),H={class:"py-10 space-y-10"},O={class:"text-2xl font-medium flex items-center gap-1"},U={class:"text-muted-foreground text-base"},G={class:"space-y-5"},K={class:"px-5 py-3 border rounded-md grid grid-cols-11 gap-10"},Q={class:"space-y-2 col-span-5"},W={class:"font-medium"},X={class:"text-muted-foreground"},Y={class:"space-y-2 col-span-5"},Z={class:"flex gap-2"},j={class:"flex items-center justify-end"},ee={key:0},se={class:"w-[70%] ml-auto mt-5 flex gap-5 items-center"},te={class:"px-5 py-3 border rounded-md grow flex gap-5 items-center"},oe={class:"space-y-5 grow"},ae={class:"flex"},ne=e("span",{class:"w-20 shrink-0"},"from",-1),ie={class:"font-medium"},ce={class:"flex"},de=e("span",{class:"w-20 shrink-0"},"message:",-1),le={class:"px-3 py-2 bg-secondary border rounded-md grow"},re={class:"text-2xl font-medium flex items-center gap-1"},_e={class:"text-muted-foreground text-base"},ue={class:"space-y-5"},pe={class:"px-5 py-3 border rounded-md grid grid-cols-11 gap-10"},me={class:"space-y-2 col-span-5"},he={class:"font-medium"},fe={class:"text-muted-foreground"},ge={class:"space-y-2 col-span-5"},ve={class:"flex gap-2"},ye={class:"flex items-center justify-end"},be={key:0},xe={class:"w-[70%] ml-auto mt-5 flex gap-5 items-center"},we={class:"px-5 py-3 border rounded-md grow flex gap-5 items-center"},ke={class:"space-y-5 grow"},Ce={class:"flex"},qe=e("span",{class:"w-20 shrink-0"},"from",-1),Je={class:"font-medium"},Be={class:"flex"},ze=e("span",{class:"w-20 shrink-0"},"message:",-1),Ne={class:"px-3 py-2 bg-secondary border rounded-md grow"},Ie=V({__name:"requests",async setup($e){let y,q;const J=M(),C=([y,q]=P(()=>J.getJobFactory()),y=await y,q(),y),b=z([]),x=z([]);C.getAllJobsOfUser(J.address).then(w=>{const v=w.map(c=>({owner:c[0],id:Number(c[1]),title:c[2],description:c[3],price:Number(c[4]),inProcess:c[5],tags:c[6],requests:[]})),u=v.map(c=>C.getJobBuyRequests(c.id));Promise.all(u).then(c=>{c.forEach((p,s)=>{const t=p.map(_=>({id:Number(_[1]),buyer:_[2],message:_[3],accepted:_[4]}));v[s].requests.push(...t)});const h=v.reduce((p,s)=>(s.requests.some(t=>t.accepted)?p.acceptedJobs.push(s):p.pendingJobs.push(s),p),{pendingJobs:[],acceptedJobs:[]});b.value=h.pendingJobs,x.value=h.acceptedJobs})});const r=S();async function B(w){if(r.value!==0&&!r.value)return;const u=await(await C.acceptBuyRequest(r.value,w)).wait();(u==null?void 0:u.status)===1&&window.location.reload()}return(w,v)=>{const u=T,c=E,h=L,p=F;return o(),i("div",H,[e("div",null,[e("h2",O,[m(" pending "),e("span",U," ("+a(n(b).length)+") ",1)]),n(b).length?(o(),N(p,{key:0,class:"mt-5 h-[500px]"},{default:l(()=>[e("ul",G,[(o(!0),i(f,null,g(n(b),s=>(o(),i("li",{key:s.id},[e("div",K,[e("div",Q,[e("div",W,a(s.title)+" #"+a(s.id),1),e("div",X,a(s.description),1)]),e("div",Y,[e("ul",Z,[(o(!0),i(f,null,g(s.tags,(t,_)=>(o(),i("li",{key:_},[d(u,{variant:"secondary"},{default:l(()=>[m(a(t),1)]),_:2},1024)]))),128))]),d(c,null,{default:l(()=>[m(a(s.price),1)]),_:2},1024)]),e("div",j,[d(h,{disabled:!s.requests.length,variant:"outline",size:"icon",onClick:t=>r.value=n(r)===s.id?void 0:s.id},{default:l(()=>[d(n(A),{class:$(["transition-transform",{"rotate-180":s.id===n(r)}])},null,8,["class"])]),_:2},1032,["disabled","onClick"])])]),d(R,{"enter-active-class":"transition-all duration-300","leave-active-class":"transition-all duration-300","enter-from-class":"opacity-0 translate-x-[10rem]","leave-to-class":"opacity-0 translate-x-[10rem]"},{default:l(()=>[s.requests.length&&s.id===n(r)?(o(),i("ul",ee,[(o(!0),i(f,null,g(s.requests,t=>(o(),i("li",{key:t.id},[e("div",se,[d(n(D),{size:16}),e("div",te,[e("div",oe,[e("div",ae,[ne,e("span",ie,a(t.buyer),1)]),e("div",ce,[de,e("div",le,a(t.message),1)])]),d(h,{disabled:t.accepted,onClick:_=>B(t.id)},{default:l(()=>[m(" accept ")]),_:2},1032,["disabled","onClick"])])])]))),128))])):k("",!0)]),_:2},1024)]))),128))])]),_:1})):k("",!0)]),e("div",null,[e("h2",re,[m(" accepted "),e("span",_e," ("+a(n(x).length)+") ",1)]),n(x).length?(o(),N(p,{key:0,class:"mt-5 h-[500px]"},{default:l(()=>[e("ul",ue,[(o(!0),i(f,null,g(n(x),s=>(o(),i("li",{key:s.id},[e("div",pe,[e("div",me,[e("div",he,a(s.title)+" #"+a(s.id),1),e("div",fe,a(s.description),1)]),e("div",ge,[e("ul",ve,[(o(!0),i(f,null,g(s.tags,(t,_)=>(o(),i("li",{key:_},[d(u,{variant:"secondary"},{default:l(()=>[m(a(t),1)]),_:2},1024)]))),128))]),d(c,null,{default:l(()=>[m(a(s.price),1)]),_:2},1024)]),e("div",ye,[d(h,{disabled:!s.requests.length,variant:"outline",size:"icon",onClick:t=>r.value=n(r)===s.id?void 0:s.id},{default:l(()=>[d(n(A),{class:$(["transition-transform",{"rotate-180":s.id===n(r)}])},null,8,["class"])]),_:2},1032,["disabled","onClick"])])]),d(R,{"enter-active-class":"transition-all duration-300","leave-active-class":"transition-all duration-300","enter-from-class":"opacity-0 translate-x-[10rem]","leave-to-class":"opacity-0 translate-x-[10rem]"},{default:l(()=>[s.requests.length&&s.id===n(r)?(o(),i("ul",be,[(o(!0),i(f,null,g(s.requests,t=>(o(),i("li",{key:t.id},[e("div",xe,[d(n(D),{size:16}),e("div",we,[e("div",ke,[e("div",Ce,[qe,e("span",Je,a(t.buyer),1)]),e("div",Be,[ze,e("div",Ne,a(t.message),1)])]),d(h,{disabled:t.accepted,onClick:_=>B(t.id)},{default:l(()=>[m(" accept ")]),_:2},1032,["disabled","onClick"])])])]))),128))])):k("",!0)]),_:2},1024)]))),128))])]),_:1})):k("",!0)])])}}});export{Ie as default};
