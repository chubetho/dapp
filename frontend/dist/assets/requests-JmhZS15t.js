import{_ as I}from"./ScrollArea.vue_vue_type_script_setup_true_lang-Q6kMADGo.js";import{c as V,d as E,q as M,y as P,s as S,v as z,z as L,o,j as n,E as e,B as p,A as i,u as a,a as N,w as l,F as h,f as d,C as f,n as R,ad as $,I as w,_ as T}from"./index-tRq5Nopp.js";import{_ as O,a as U}from"./Badge.vue_vue_type_script_setup_true_lang-huy-mP_W.js";import{C as A}from"./chevron-down-BUIsJgtE.js";/**
 * @license lucide-vue-next v0.297.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=V("CornerDownRightIcon",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]),G={class:"py-10"},H={class:"text-2xl font-medium flex items-center gap-1"},K={class:"text-muted-foreground text-base"},Q={class:"space-y-5"},W={class:"px-5 py-3 border rounded-md grid grid-cols-11 gap-10"},X={class:"space-y-2 col-span-5"},Y={class:"font-medium"},Z={class:"text-muted-foreground"},j={class:"space-y-2 col-span-5"},ee={class:"flex gap-2"},se={class:"flex items-center justify-end"},te={key:0},oe={class:"w-[70%] ml-auto mt-5 flex gap-5 items-center"},ae={class:"px-5 py-3 border rounded-md grow flex gap-5 items-center"},ne={class:"space-y-5 grow"},ce={class:"flex"},ie=e("span",{class:"w-20 shrink-0"},"from",-1),de={class:"font-medium"},le={class:"flex"},re=e("span",{class:"w-20 shrink-0"},"message:",-1),_e={class:"px-3 py-2 bg-secondary border rounded-md grow"},ue={class:"py-10"},pe={class:"text-2xl font-medium flex items-center gap-1"},me={class:"text-muted-foreground text-base"},he={class:"space-y-5"},fe={class:"px-5 py-3 border rounded-md grid grid-cols-11 gap-10"},ge={class:"space-y-2 col-span-5"},ve={class:"font-medium"},ye={class:"text-muted-foreground"},be={class:"space-y-2 col-span-5"},xe={class:"flex gap-2"},ke={class:"flex items-center justify-end"},we={key:0},Ce={class:"w-[70%] ml-auto mt-5 flex gap-5 items-center"},qe={class:"px-5 py-3 border rounded-md grow flex gap-5 items-center"},Je={class:"space-y-5 grow"},Be={class:"flex"},ze=e("span",{class:"w-20 shrink-0"},"from",-1),Ne={class:"font-medium"},Re={class:"flex"},$e=e("span",{class:"w-20 shrink-0"},"message:",-1),Ae={class:"px-3 py-2 bg-secondary border rounded-md grow"},Me=E({__name:"requests",async setup(De){let g,q;const J=M(),F=P(),C=([g,q]=S(()=>J.getJobFactory()),g=await g,q(),g),v=z([]),y=z([]);C.getAllJobsOfUser(J.address).then(b=>{const x=b.map(c=>({owner:c[0],id:Number(c[1]),title:c[2],description:c[3],price:Number(c[4]),inProcess:c[5],tags:c[6],requests:[]})),k=x.map(c=>C.getJobBuyRequests(c.id));Promise.all(k).then(c=>{c.forEach((u,s)=>{const t=u.map(_=>({id:Number(_[1]),buyer:_[2],message:_[3],accepted:_[4]}));x[s].requests.push(...t)});const m=x.reduce((u,s)=>(s.requests.some(t=>t.accepted)?u.acceptedJobs.push(s):u.pendingJobs.push(s),u),{pendingJobs:[],acceptedJobs:[]});v.value=m.pendingJobs,y.value=m.acceptedJobs})});const r=L();async function B(b){if(!(r.value!==0&&!r.value))try{await C.acceptBuyRequest(r.value,b)}catch{F.push("/error")}}return(b,x)=>{const k=O,c=U,m=T,u=I;return o(),n("div",null,[e("div",G,[e("h2",H,[p(" pending "),e("span",K," ("+i(a(v).length)+") ",1)]),a(v).length?(o(),N(u,{key:0,class:"mt-10 h-[500px]"},{default:l(()=>[e("ul",Q,[(o(!0),n(h,null,f(a(v),s=>(o(),n("li",{key:s.id},[e("div",W,[e("div",X,[e("div",Y,i(s.title),1),e("div",Z,i(s.description),1)]),e("div",j,[e("ul",ee,[(o(!0),n(h,null,f(s.tags,(t,_)=>(o(),n("li",{key:_},[d(k,{variant:"secondary"},{default:l(()=>[p(i(t),1)]),_:2},1024)]))),128))]),d(c,null,{default:l(()=>[p(i(s.price),1)]),_:2},1024)]),e("div",se,[d(m,{disabled:!s.requests.length,variant:"outline",size:"icon",onClick:t=>r.value=a(r)===s.id?void 0:s.id},{default:l(()=>[d(a(A),{class:R(["transition-transform",{"rotate-180":s.id===a(r)}])},null,8,["class"])]),_:2},1032,["disabled","onClick"])])]),d($,{"enter-active-class":"transition-all duration-300","leave-active-class":"transition-all duration-300","enter-from-class":"opacity-0 translate-x-[10rem]","leave-to-class":"opacity-0 translate-x-[10rem]"},{default:l(()=>[s.requests.length&&s.id===a(r)?(o(),n("ul",te,[(o(!0),n(h,null,f(s.requests,t=>(o(),n("li",{key:t.id},[e("div",oe,[d(a(D),{size:16}),e("div",ae,[e("div",ne,[e("div",ce,[ie,e("span",de,i(t.buyer),1)]),e("div",le,[re,e("div",_e,i(t.message),1)])]),d(m,{disabled:t.accepted,onClick:_=>B(t.id)},{default:l(()=>[p(" accept ")]),_:2},1032,["disabled","onClick"])])])]))),128))])):w("",!0)]),_:2},1024)]))),128))])]),_:1})):w("",!0)]),e("div",ue,[e("h2",pe,[p(" accepted "),e("span",me," ("+i(a(y).length)+") ",1)]),a(y).length?(o(),N(u,{key:0,class:"mt-10 h-[500px]"},{default:l(()=>[e("ul",he,[(o(!0),n(h,null,f(a(y),s=>(o(),n("li",{key:s.id},[e("div",fe,[e("div",ge,[e("div",ve,i(s.title),1),e("div",ye,i(s.description),1)]),e("div",be,[e("ul",xe,[(o(!0),n(h,null,f(s.tags,(t,_)=>(o(),n("li",{key:_},[d(k,{variant:"secondary"},{default:l(()=>[p(i(t),1)]),_:2},1024)]))),128))]),d(c,null,{default:l(()=>[p(i(s.price),1)]),_:2},1024)]),e("div",ke,[d(m,{disabled:!s.requests.length,variant:"outline",size:"icon",onClick:t=>r.value=a(r)===s.id?void 0:s.id},{default:l(()=>[d(a(A),{class:R(["transition-transform",{"rotate-180":s.id===a(r)}])},null,8,["class"])]),_:2},1032,["disabled","onClick"])])]),d($,{"enter-active-class":"transition-all duration-300","leave-active-class":"transition-all duration-300","enter-from-class":"opacity-0 translate-x-[10rem]","leave-to-class":"opacity-0 translate-x-[10rem]"},{default:l(()=>[s.requests.length&&s.id===a(r)?(o(),n("ul",we,[(o(!0),n(h,null,f(s.requests,t=>(o(),n("li",{key:t.id},[e("div",Ce,[d(a(D),{size:16}),e("div",qe,[e("div",Je,[e("div",Be,[ze,e("span",Ne,i(t.buyer),1)]),e("div",Re,[$e,e("div",Ae,i(t.message),1)])]),d(m,{disabled:t.accepted,onClick:_=>B(t.id)},{default:l(()=>[p(" accept ")]),_:2},1032,["disabled","onClick"])])])]))),128))])):w("",!0)]),_:2},1024)]))),128))])]),_:1})):w("",!0)])])}}});export{Me as default};
